function tar_config {
   echo "tar.gz    -> master config"
   rm -rf /ssd/master.* /ssd/.jenkins
   cd /home/tomcat7
   tar -zcf $TAR_FILE .jenkins --exclude=**/plugins/** --exclude=**/workspace/** --exclude=**/logs/slaves/**
}


MY_DIR="$( cd "$( dirname "$0" )" && pwd )"
ME=$(basename $0)
source $MY_DIR/../common/functions.sh

usage() { echo "Usage: $ME [-q --quiet] [-h --help] stack version password secret_key" 1>&2; exit 1; }

STACK=$1
VERSION=$2
GPG_PASSPHRASE=$3
SECRET_KEY=$4

GROUP_ID=org.jenkins
ARTIFACT_ID=jenkins-master-backup
CLASSIFIER=$STACK-$TIMESTAMP
TYPE=tar.gz.gpg

PREFIX=external
ACCESS_KEY=AKIAJFD5IM7IPVVUEBNA
BUCKET=maven.kuali.org

TAR_FILE=/ssd/master.tar.gz
tar_config
GPG_DECRYPTED=$TAR_FILE
GPG_ENCRYPTED=$TAR_FILE.gpg
encrypt_file $GPG_DECRYPTED $GPG_ENCRYPTED

#source $MY_DIR/../common/m2s3upload $ZIP $ACCESS_KEY $ACCESS_KEY $SECRET_KEY $GROUP_ID $ARTIFACT_ID $VERSION --type=$TYPE  
