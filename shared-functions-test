function kantmod {
  {
    target=$1
    environment=$2
    klogmod "executing target: $target against environment: $environment"
    // kexecmod "$ANT_COMMAND -Ddeployment.directory=$DEPLOY_BASE_DIRECTORY/$environment/$JAVA_APPLICATION_CODE -Dshared.external.build.properties=$ANT_PROPERTIES_FILE -f $ANT_BUILD_FILE $target"
    return 0
  } >> $SCRIPT_LOG 2>&1
}
typeset -xf kantmod

function klogmod {
  {
    typeset message=$1
    echo "`date +%Y%m%d.%H.%M.%S`: $message"
  } >> $SCRIPT_LOG 2>&1
}
typeset -xf klogmod

function kexecmod {
  {
    typeset command=$1
    klogmod "executing command: $command"
    eval $command
    typeset return_status=$?
    if [[ "$return_status" != "0" ]]
      then
        kendmod $return_status
    fi
    return $return_status
  } >> $SCRIPT_LOG 2>&1
}
typeset -xf kexecmod

function kendmod {
  {
    typeset exit_status=$1
    klog "ending with exit status: $exit_status"
    if [[ "$exit_status" != "0" ]]
      then
        kmailmod $APPLICATION_CFG_MAIL_LIST "$SCRIPT_NAME has errors" "see $SCRIPT_LOG"
    fi
    exit $exit_status
  } >> $SCRIPT_LOG 2>&1
}
typeset -xf kendmod

function kmailmod {
  {
    typeset recipient=$1
    typeset subject=$2
    typeset message=$3
    if [[ "$SEND_MAIL" = "true" ]]
      then
        klogmod "mailing recipent: $recipient"
        echo "$message" | mail -s "$subject" $recipient
    else
      echo "SEND_MAIL is turned off"
    fi 
  } >> $SCRIPT_LOG 2>&1
}
typeset -xf kmailmod