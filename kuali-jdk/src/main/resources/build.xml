<?xml version="1.0"?>
<project name="JDK Manager">

  <target name="updatejdk7">
    <property name="platform.size" value="linux-x64" />
    <property name="jdk.major.version" value="7" />
    <property name="jdk.minor.version" value="${minor}" />
    <property name="jdk.version" value="${jdk.major.version}.0.${jdk.minor.version}" />

    <property name="jdk.dir" value="${user.home}/.jdk/7" />
    <property name="jdk.kuali.version" value="jdk${jdk.major.version}-1.${jdk.major.version}.0-u${jdk.minor.version}" />

    <property name="ora.dir" value="jdk1.${jdk.major.version}.0_${jdk.minor.version}" />

    <property name="kuali.dir" value="${jdk.kuali.version}" />
    <property name="jdk.version.kuali.dir" value="${jdk.dir}/${kuali.dir}" />

    <property name="jdk.version.ora.dir" value="${jdk.version.kuali.dir}/${ora.dir}" />

    <property name="jdk.kuali.zip.file" value="${jdk.kuali.version}-${platform.size}.zip" />
    <property name="jdk.version.kuali.zip" value="${jdk.dir}/${jdk.kuali.zip.file}" />

    <property name="jdk.tar.file" value="jdk-${jdk.major.version}u${jdk.minor.version}-${platform.size}.tar" />
    <property name="jdk.tar" value="${jdk.version.kuali.dir}/${jdk.tar.file}" />
    <property name="jdk.gz" value="${jdk.dir}/${jdk.tar.file}.gz" />

    <echo message="${jdk.version}" />

    <echo message="jdk.version.kuali.dir: ${jdk.version.kuali.dir}" />
    <echo message="jdk.version.ora.dir: ${jdk.version.ora.dir}" />

    <delete includeemptydirs="true" failonerror="false">
      <fileset dir="${jdk.version.kuali.dir}" />
      <dirset dir="${jdk.version.kuali.dir}" />
      <fileset file="${jdk.version.kuali.zip}" />
    </delete>

    <delete includeemptydirs="true" failonerror="false">
      <fileset dir="${jdk.version.ora.dir}" />
      <dirset dir="${jdk.version.ora.dir}" />
      <fileset file="${jdk.version.kuali.zip}" />
    </delete>
    <chmod file="${jdk.gz}" perm="755" />

    <mkdir dir="${jdk.version.kuali.dir}" />

    <untar src="${jdk.gz}" dest="${jdk.version.kuali.dir}" compression="gzip" />

    <echo message="delete ${jdk.version.ora.dir}/src.zip" />

    <delete file="${jdk.version.ora.dir}/src.zip" />

    <echo message="mv ${jdk.version.kuali.dir}/${ora.dir} to ${jdk.version.kuali.dir}/${kuali.dir}" />

    <move todir="${jdk.version.kuali.dir}/${kuali.dir}" verbose="true" includeemptydirs="true">
      <fileset dir="${jdk.version.kuali.dir}/${ora.dir}" />
    </move>

    <echo message="zip ${jdk.version.kuali.dir} to ${jdk.version.kuali.zip}" />

    <delete file="${jdk.version.kuali.dir}/${kuali.dir}/man/ja" />
    <mkdir dir="${jdk.version.kuali.dir}/${kuali.dir}/man/ja" />

    <copy todir="${jdk.version.kuali.dir}/${kuali.dir}/man/ja/" includeemptydirs="true">
      <dirset dir="${jdk.version.kuali.dir}/${kuali.dir}/man/ja_JP.UTF-8" />
    </copy>

    <copy todir="${jdk.version.kuali.dir}/${kuali.dir}/man/ja/" includeemptydirs="true">
      <fileset dir="${jdk.version.kuali.dir}/${kuali.dir}/man/ja_JP.UTF-8" />
    </copy>

    <copy tofile="${jdk.version.kuali.dir}/${kuali.dir}/bin/ControlPanel" overwrite="true" force="true" file="${jdk.version.kuali.dir}/${kuali.dir}/bin/jcontrol" />

    <copy tofile="${jdk.version.kuali.dir}/${kuali.dir}/jre/bin/ControlPanel" overwrite="true" force="true" file="${jdk.version.kuali.dir}/${kuali.dir}/jre/bin/jcontrol" />

    <copy tofile="${jdk.version.kuali.dir}/${kuali.dir}/jre/lib/amd64/server/libjsig.so" overwrite="true" force="true" file="${jdk.version.kuali.dir}/${kuali.dir}/jre/lib/amd64/libjsig.so" />

    <zip destfile="${jdk.version.kuali.zip}" basedir="${jdk.version.kuali.dir}" />
    <delete includeemptydirs="true" failonerror="true">
      <fileset dir="${jdk.version.kuali.dir}" />
      <dirset dir="${jdk.version.kuali.dir}" />
    </delete>
  </target>


  <target name="updatejdk6">
    <property name="platform.size" value="linux-x64" />
    <property name="jdk.major.version" value="6" />
    <property name="jdk.minor.version" value="${minor}" />
    <property name="jdk.version" value="${jdk.major.version}.0.${jdk.minor.version}" />

    <property name="jdk.kuali.version" value="jdk${jdk.major.version}-1.${jdk.major.version}.0-u${jdk.minor.version}" />
    <property name="jdk.ora.version" value="jdk-${jdk.major.version}u${jdk.minor.version}-${platform.size}" />
    <property name="ora.dir" value="jdk1.${jdk.major.version}.0_${jdk.minor.version}" />

    <property name="jdk.dir" value="${user.home}/.jdk/6" />


    <property name="jdk.bin.path" value="${jdk.dir}" />
    <property name="jdk.bin.name.file" value="jdk-${jdk.major.version}u${jdk.minor.version}-${platform.size}.bin" />


    <property name="kuali.dir" value="jdk${jdk.major.version}-1.${jdk.major.version}.0-u${jdk.minor.version}" />
    <property name="jdk.version.ora.dir" value="${jdk.dir}/jdk1.${jdk.major.version}.0_${jdk.minor.version}" />

    <property name="jdk.kuali.zip.file" value="${jdk.kuali.version}.zip" />
    <property name="jdk.zip" value="${jdk.kuali.zip.file}" />
    <property name="jdk.version.kuali.zip" value="${jdk.dir}/${jdk.kuali.zip.file}" />
    <property name="jdk.version.kuali.dir" value="${jdk.dir}/${jdk.kuali.version}" />

    <echo message="${jdk.version}" />
    <echo message="${jdk.version.kuali.dir}" />
    <echo message="${jdk.version.ora.dir}" />


    <delete includeemptydirs="true" failonerror="no">
      <dirset dir="${jdk.version.ora.dir}" />
      <dirset dir="${jdk.version.kuali.dir}" />
      <fileset file="${jdk.version.kuali.zip}" />
      <fileset file="${jdk.zip}" />
    </delete>

    <delete includeemptydirs="true" failonerror="no">
      <dirset dir="${jdk.version.ora.dir}" />
      <dirset dir="${jdk.version.kuali.dir}" />
      <fileset file="${jdk.version.kuali.zip}" />
      <fileset file="${jdk.zip}" />
    </delete>

    <chmod file="${jdk.bin.path}/${jdk.bin.name.file}" perm="755" />
    <exec dir="${jdk.bin.path}" executable="${jdk.bin.name.file}" />

    <delete file="${jdk.version.ora.dir}/src.zip" />

    <symlink action="record" linkfilename="linked.record">
      <fileset dir="${jdk.version.ora.dir}" includes="**/**" />
    </symlink>

    <zip destfile="${jdk.version.kuali.zip}" basedir="${jdk.version.ora.dir}/" whenempty="create" />

    <mkdir dir="${jdk.version.kuali.dir}" />
    <mkdir dir="${jdk.version.kuali.dir}/${kuali.dir}" />

    <move file="${jdk.version.kuali.zip}" todir="${jdk.version.kuali.dir}/${kuali.dir}" />
    <unzip src="${jdk.version.kuali.dir}/${kuali.dir}/${jdk.kuali.zip.file}" dest="${jdk.version.kuali.dir}/${kuali.dir}/" />
    <delete file="${jdk.version.kuali.dir}/${kuali.dir}/${jdk.kuali.zip.file}" />

    <symlink action="recreate" failonerror="no" overwrite="yes">
      <fileset dir="${jdk.version.kuali.dir}/${kuali.dir}" includes="*/dir.links" />
    </symlink>

    <delete>
      <fileset file="${jdk.version.kuali.dir}/${kuali.dir}/man/linked.record" />
      <fileset file="${jdk.version.kuali.dir}/${kuali.dir}/bin/linked.record" />
      <fileset file="${jdk.version.kuali.dir}/${kuali.dir}/jre/javaws/linked.record" />
      <fileset file="${jdk.version.kuali.dir}/${kuali.dir}/jre/bin/linked.record" />
      <fileset file="${jdk.version.kuali.dir}/${kuali.dir}/jre/lib/amd64/server/linked.record" />
    </delete>

    <zip destfile="${jdk.version.kuali.zip}" basedir="${jdk.version.kuali.dir}/" whenempty="create" />

    <echo message="${jdk.version.ora.dir}" />
    <echo message="${jdk.version.kuali.dir}" />

    <delete includeemptydirs="true" failonerror="true">
      <fileset dir="${jdk.version.ora.dir}" />
      <dirset dir="${jdk.version.ora.dir}" />
      <fileset dir="${jdk.version.kuali.dir}" />
      <dirset dir="${jdk.version.kuali.dir}" />
    </delete>


    <deltree dir="${jdk.version.ora.dir}" />
  </target>
</project>
